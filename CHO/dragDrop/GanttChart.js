var PX=new function(){function B(e){if(e.pageX||e.pageY){return{x:e.pageX,y:e.pageY}}else{var t=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;var n=document.body.scrollLeft?document.body.scrollLeft:document.documentElement.scrollLeft;return{x:e.clientX+n-document.body.clientLeft,y:e.clientY+t-document.body.clientTop}}}function j(e){var t=0;var n=0;while(e.offsetParent){t+=e.offsetLeft;n+=e.offsetTop;e=e.offsetParent}t+=e.offsetLeft;n+=e.offsetTop;return{x:t,y:n}}function F(e,t){t=t||window.event;var n=j(e);var r=B(t);return{x:r.x-n.x,y:r.y-n.y}}function I(){w=false;E=false;b=false;if(S!=null){z(S.id).innerHTML="";S.style.display="inline";S.style.visibility="hidden"}return true}function q(){S=z("divContext");S.onmousemove=function(){w=true};S.onmouseout=function(){w=false}}function R(e,t){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){t+="&navigator=chrome"}var n;var r;if(e==""){return}if(window.XMLHttpRequest){n=new XMLHttpRequest}else{n=new ActiveXObject("Microsoft.XMLHTTP")}n.onreadystatechange=function(){if(n.readyState==4&&n.status==200){r=n.responseText;if(r.indexOf("login.aspx")>-1){window.location.reload()}else{z(e).innerHTML=r;k=document.createElement("div");k.style.cssText="position:absolute;display:none;";z(e).appendChild(k)}}};n.open("POST","DataExchange.aspx",false);n.setRequestHeader("Content-type","application/x-www-form-urlencoded");n.send(t)}function U(e,t){var n;var r;if(e==""){return}if(window.XMLHttpRequest){n=new XMLHttpRequest}else{n=new ActiveXObject("Microsoft.XMLHTTP")}n.onreadystatechange=function(){if(n.readyState==4&&n.status==200){r=n.responseText;if(r.indexOf("login.aspx")>-1){window.location.reload()}else{z(e).innerHTML=r}}};n.open("POST","DataExchange.aspx",false);n.setRequestHeader("Content-type","application/x-www-form-urlencoded");n.send(t)}function z(e){return document.getElementById(e)}var e=null;var t=68;var n=false;var r=null;var i=null;var s=65;var o=false;var u=71;var a=false;var f=false;var l=null;var c=null;var h=0;var p=0;var d=83;var v=false;var m=null;var g=67;var y=false;var b=false;var w=false;var E=false;var S=null;var x=0;var T=0;var N=0;var C=0;var k=null;var L=0;var A=0;var O=null;var M=null;var _=null;var D=90;var P=0;var H=0;this.mouseMove=function(n){n=n||window.event;var r=n.target||n.srcElement;var i=B(n);if(O){k.style.top=i.y-e.y-N-x+"px";k.style.left=i.x-e.x-C-T+"px";return false}if(f&&l&&c){k.style.top=i.y-e.y-N-x-h+"px";k.style.left=i.x-e.x-C-T-p+"px";return false}if(!w&&!E&&b){I();return false}};this.mouseUp=function(t){t=t||window.event;f=false;if(t.button!=2&&O){R("ganttZone","action=updateorder&timepixels="+parseInt(k.offsetLeft)+"&lineno="+z("ganttZone").getAttribute("crntLine")+"&orderkey="+O.id);window.status="move order '"+O.id+"' to a new start time";for(var n=k.childNodes.length-1;n>-1;n--){k.removeChild(k.childNodes[n])}k.style.display="none";O=null}};this.mouseDown=function(s){f=true;s=s||window.event;var u=s.target||s.srcElement;var d=0;if(s.button!=2){x=parseInt(u.style.marginTop);T=parseInt(u.style.marginLeft);N=k.parentNode.offsetTop;C=k.parentNode.offsetLeft;if(u.className.indexOf("g-")==0){if(n){if(!r){r=u.id;u.style.border="1px dashed red"}else{if(i&&i!=r){z(i).style.border="1px solid black"}i=u.id;u.style.border="1px dashed red"}return}if(o){if(!r){r=u.id;u.style.border="1px dashed red"}else{if(i&&i!=r){z(i).style.border="1px solid black"}i=u.id;u.style.border="1px dashed red"}return}if(a){if(!l){l=u.id;u.style.border="1px dashed yellow"}else{if(c){return;z(c).style.border="1px solid black";for(d=k.childNodes.length-1;d>-1;d--){k.parentNode.getElementById(k.childNodes[d].id).style.visibility="visible";k.removeChild(k.childNodes[d])}}c=u.id;u.style.border="1px dashed yellow";if(c!=l){var g=null;h=z(c).offsetTop-z(l).offsetTop;p=z(c).offsetLeft-z(l).offsetLeft;if(z(l).offsetLeft>z(c).offsetLeft){g=l;l=c;c=g}var b=z(l);var w=b.offsetLeft;for(d=k.childNodes.length-1;d>-1;d--){k.removeChild(k.childNodes[d])}var E=b.cloneNode(true);k.appendChild(E);E.style.left="0px";if(g){h=0;p=0}b.style.visibility="hidden";do{b=b.nextSibling;E=b.cloneNode(true);k.appendChild(E);E.style.left=b.offsetLeft-w+"px";b.style.visibility="hidden"}while(b.id!=c);k.style.left=z(l).style.left;k.style.top=z(l).offsetTop-x+"px";k.style.width=parseInt(E.style.left)+parseInt(E.style.width)+parseInt(E.style.borderWidth)*2+"px";k.style.display="block";e=F(u,s)}}return}if(v){m=u;return}if(y){m=u;return}var S=j(u);e=F(u,s);O=u.cloneNode(true);k.style.left=u.style.left;k.style.top=u.offsetTop-x+"px";u.style.visibility="hidden";for(d=k.childNodes.length-1;d>-1;d--){k.removeChild(k.childNodes[d])}O.style.left="0px";k.appendChild(O);k.style.display="block"}}else{}};this.ContextShow=function(t){if(t==null)t=window.event;var n=t.target!=null?t.target:t.srcElement;var r=j(n);var i=B(t);if(n.className.indexOf("g-")==0){b=true;U(S.id,"action=contextMenu&lineno="+z("ganttZone").getAttribute("crntLine")+"&orderkey="+n.id);window.status="order context menu pop up "+n.id}else{b=false}if(b){var s=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;S.style.visibility="hidden";S.style.display="block";S.style.position="absolute";S.style.left=i.x-8+"px";if(i.y-s<=70){S.style.top=i.y-16+"px"}else{if(i.y-s-70+16>parseInt(S.offsetHeight)){S.style.top=i.y-parseInt(S.offsetHeight)+24+"px"}else{S.style.top=s+70-8+"px"}}S.style.visibility="visible";return false}var o=n;var u=5;while(o&&u>0){if(o.className.indexOf("cmenu")==0){b=true;return false}o=o.parentNode;u-=1}};this.CloseContext=function(){return I()};this.newStartTime=function(t){R("ganttZone","action=newStartTime&lineno="+z("ganttZone").getAttribute("crntLine")+"&orderkey="+t.parentNode.parentNode.parentNode.getAttribute("id1")+"&newTime="+t.value);window.status="order '"+t.parentNode.parentNode.parentNode.getAttribute("id1")+"' is changed to new time #"+t.value+"#"};this.changeLine=function(t){R("ganttZone","action=changeline&lineno="+z("ganttZone").getAttribute("crntLine")+"&orderkey="+t.parentNode.getAttribute("id1")+"&newlineno="+t.getAttribute("id1"));window.status="order '"+t.parentNode.getAttribute("id1")+"' is changed to new line "+t.getAttribute("id1")};this.dsplyCntxtMnuLst=function(t){E=true;t.parentNode.style.display="block";t.style.backgroundColor="Silver";var n=t.parentNode.getElementsByTagName("li");for(var r=n.length-1;r>-1;r--){if(n[r]!==t){n[r].style.backgroundColor="white"}}};this.subMouseOverContex=function(e){E=e};this.keyDown=function(r){r=r||window.event;if(S.style.display!="block"){if(r.keyCode==t){n=true;return true}if(r.keyCode==s){o=true;return true}if(r.keyCode==u){a=true;return true}if(r.keyCode==d){v=true;return true}if(r.keyCode==g){y=true;return true}}};this.keyUp=function(f){f=f||window.event;if(S.style.display!="block"){if(f.keyCode==d){v=false;R("ganttZone","action=pullscrew&orderkey="+m.id+"&lineno="+z("ganttZone").getAttribute("crntLine")+"");window.status="screw pulling is changed for order '"+m.id+"'";m=null;return true}if(f.keyCode==g){y=false;R("ganttZone","action=cleanscrew&orderkey="+m.id+"&lineno="+z("ganttZone").getAttribute("crntLine")+"");window.status="screw cleaning is changed for order '"+m.id+"'";m=null;return true}if(f.keyCode==u){a=false;if(l){z(l).style.border="1px solid black"}if(c){z(c).style.border="1px solid black"}if(l&&c&&l!=c){R("ganttZone","action=moveingroup&frstslctnID="+l+"&scndslctnID="+c+"&areaoffsetleft="+parseInt(k.offsetLeft)+"&lineno="+z("ganttZone").getAttribute("crntLine")+"");window.status="Start times were changed for a group of orders"}l=null;c=null;return true}if(f.keyCode==t){n=false;if(r){z(r).style.border="1px solid black"}if(i){z(i).style.border="1px solid black"}if(r&&i&&r!=i){R("ganttZone","action=updateorderinbatch&frstslctnID="+r+"&scndslctnID="+i+"&lineno="+z("ganttZone").getAttribute("crntLine")+"");window.status="A group of order were changed (latter order's start time equal to the earlier one's finish time)"}r=null;i=null;return true}if(f.keyCode==s){o=false;if(r){z(r).style.border="1px solid black"}if(i){z(i).style.border="1px solid black"}if(r&&i&&r!=i){R("ganttZone","action=updateorderinbatchA&frstslctnID="+r+"&scndslctnID="+i+"&lineno="+z("ganttZone").getAttribute("crntLine")+"");window.status="A group of order were changed (latter order's start time equal to the earlier one's finish time)"}r=null;i=null;return true}}};this.dsplyOrderByLine=function(t){if(z("ganttZone").getAttribute("crntLine")!=t.getAttribute("id").toString()){z("ganttZone").setAttribute("crntLine",t.getAttribute("id").toString());R("ganttZone","action=orderlines&lineno="+t.getAttribute("id").toString()+"");window.status="show orders by production line "+t.getAttribute("id").toString();t.style.backgroundColor="white";window.scrollBy(0,-1);window.scrollTo(P,H)}var n=t.parentNode.getElementsByTagName("td");for(var r=n.length-1;r>-1;r--){if(n[r]!==t){n[r].style.backgroundColor="#9999CC"}}I()};this.newExcelFrom=function(t,n){var r;if(window.XMLHttpRequest){r=new XMLHttpRequest}else{r=new ActiveXObject("Microsoft.XMLHTTP")}r.onreadystatechange=function(){if(r.readyState==4&&r.status==200){var e=new Date;var t=e.toLocaleTimeString();z(n).innerHTML="-("+t+")";if(r.responseText.indexOf("loginBySSO")<0){z("dfCount").innerHTML="("+r.responseText+")"}else{z("logined").href=r.responseText;z("logined").innerHTML="Need login first"}}};r.open("POST",t,true);r.setRequestHeader("Content-type","application/x-www-form-urlencoded");r.send("action=generateExcelFile")};getScrollXY=function(){var t=0;var n=0;if(typeof window.pageYOffset=="number"){n=window.pageYOffset;t=window.pageXOffset}else if(document.documentElement.scrollLeft){n=document.documentElement.scrollTop;t=document.documentElement.scrollLeft}else if(document.body.scrollLeft){n=document.body.scrollTop;t=document.body.scrollLeft}return{x:t,y:n}};this.onload=function(){k=document.createElement("div");k.style.cssText="position:absolute;display:none;";R("lines","action=productionlines");U("scalar","action=scalar");var e=z("ganttZone");e.className="DragContainer";U("bckgrndImg","action=bckgrndImg");if(document.getElementsByTagName("td")){document.getElementsByTagName("td")[0].onclick()}z("scalar").style.left=e.style.left;z("scalar").style.width=z("scalar").childNodes.length*D+"px";z("bckgrndImg").style.width=z("scalar").style.width;M=z("scalar");_=z("bckgrndImg");if(M.childNodes.length>1){D=parseInt(M.childNodes[1].style.left)-parseInt(M.childNodes[0].style.left)}q()};this.onscroll=function(){P=getScrollXY().x+L;H=getScrollXY().y+A;if(M==null){M=z("scalar")}if(_==null){_=z("bckgrndImg")}M.style.left=-P+"px";_.style.left=-P+"px"}};document.onmousemove=PX.mouseMove;document.onmousedown=PX.mouseDown;document.onmouseup=PX.mouseUp;document.onkeydown=PX.keyDown;document.onkeyup=PX.keyUp;document.oncontextmenu=PX.ContextShow;window.onscroll=PX.onscroll;window.onload=PX.onload